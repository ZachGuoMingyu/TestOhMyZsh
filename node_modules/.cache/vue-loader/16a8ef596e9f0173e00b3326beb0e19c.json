{"remainingRequest":"/Users/Zach/Desktop/Vue/dudu/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/Zach/Desktop/Vue/dudu/src/components/City/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/Zach/Desktop/Vue/dudu/src/components/City/index.vue","mtime":1584088853943},{"path":"/Users/Zach/Desktop/Vue/dudu/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/Zach/Desktop/Vue/dudu/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/Zach/Desktop/Vue/dudu/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/Zach/Desktop/Vue/dudu/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOidDaXR5JywKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY2l0eUxpc3QgOiBbXSwKICAgICAgaG90TGlzdCA6IFtdICAKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmF4aW9zLmdldCgnL2FwaS9jaXR5TGlzdCcpLnRoZW4oKHJlcykgPT4gewogICAgICB2YXIgbXNnID0gcmVzLmRhdGEubXNnOwogICAgICBpZiAobXNnID09PSAnb2snKSB7CiAgICAgICAgdmFyIGNpdGllcyA9IHJlcy5kYXRhLmRhdGEuY2l0aWVzOwogICAgICAgIHZhciB7Y2l0eUxpc3QsaG90TGlzdH0gPSB0aGlzLmZvcm1hdENpdHlMaXN0KGNpdGllcyk7CiAgICAgICAgdGhpcy5jaXR5TGlzdCA9IGNpdHlMaXN0OwogICAgICAgIHRoaXMuaG90TGlzdCA9IGhvdExpc3Q7CiAgICAgIH0KICAgIH0pCiAgfSwKICBtZXRob2RzOiB7CiAgICBmb3JtYXRDaXR5TGlzdChjaXRpZXMpewogICAgICB2YXIgY2l0eUxpc3QgPSBbXTsKICAgICAgdmFyIGhvdExpc3QgPSBbXTsKCiAgICAgIGZvcih2YXIgaSA9IDA7IGk8Y2l0aWVzLmxlbmd0aDsgaSsrKXsKICAgICAgICBpZiAoY2l0aWVzW2ldLmlzSG90ID09PSAxKSB7CiAgICAgICAgICBob3RMaXN0LnB1c2goY2l0aWVzW2ldKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2l0aWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGZpcnN0TGV0dGVyID0gY2l0aWVzW2ldLnB5LnN1YnN0cmluZygwLDEpLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgaWYgKHRvQ29tKGZpcnN0TGV0dGVyKSkgey8v5paw5re75YqgaW5kZXgKICAgICAgICAgIGNpdHlMaXN0LnB1c2goeyBpbmRleCA6IGZpcnN0TGV0dGVyLCBsaXN0IDogWyB7IG5tIDogY2l0aWVzW2ldLm5tLCBpZCA6Y2l0aWVzW2ldLmlkIH0gXSB9KTsKICAgICAgICB9CiAgICAgICAgZWxzZXsvL+e0r+WKoOW3suaciWluZGV4CiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNpdHlMaXN0Lmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGlmIChjaXR5TGlzdFtqXS5pbmRleCA9PT0gZmlyc3RMZXR0ZXIpIHsKICAgICAgICAgICAgICBjaXR5TGlzdFtqXS5saXN0LnB1c2goeyBubTpjaXRpZXNbaV0ubm0sIGlkIDogY2l0aWVzW2ldLmlkfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNpdHlMaXN0LnNvcnQoKG4xLG4yKSA9PiB7CiAgICAgICAgaWYgKG4xLmluZGV4ID4gbjIuaW5kZXgpIHsKICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmKG4xLmluZGV4IDwgbjIuaW5kZXgpewogICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH1lbHNlewogICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIGZ1bmN0aW9uIHRvQ29tKGZpcnN0TGV0dGVyKSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaXR5TGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKGNpdHlMaXN0W2ldLmluZGV4ID09PSBmaXJzdExldHRlcikgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIHJldHVybiB7CiAgICAgICAgY2l0eUxpc3QsCiAgICAgICAgaG90TGlzdAogICAgICB9CiAgICB9LAogICAgaGFuZGxlVG9JbmRleChpbmRleCl7CiAgICAgIHZhciBoMiA9IHRoaXMuJHJlZnMuY2l0eV9zb3J0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoMicpOwogICAgICB0aGlzLiRyZWZzLmNpdHlfc29ydC5wYXJlbnROb2RlLnNjcm9sbFRvcCA9IGgyW2luZGV4XS5vZmZzZXRUb3A7CiAgICB9CiAgfSwKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/City","sourcesContent":["<template>\n  <div class=\"city_body\">\n    <div class=\"city_list\">\n      <div class=\"city_hot\">\n        <h2>热门城市</h2>\n        <ul class=\"clearfix\">\n          <li v-for=\"item in hotList\" :key=\"item.id\">\n            {{item.nm}}\n          </li>\n        </ul>\n      </div>\n      <div class=\"city_sort\" ref=\"city_sort\">\n        <div v-for=\"item in cityList\" :key=\"item.index\">\n          <h2>{{item.index}}</h2>\n          <ul>\n            <li v-for=\"itemList in item.list\" :key=\"itemList.id\">\n              {{itemList.nm}}\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n    <div class=\"city_index\">\n      <ul>\n        <li v-for=\"(item,index) in cityList\" :key=\"item.index\" @touchstart=\"handleToIndex(index)\">\n          {{item.index}}\n        </li>\n      </ul>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name:'City',\n  data() {\n    return {\n      cityList : [],\n      hotList : []  \n    }\n  },\n  mounted() {\n    this.axios.get('/api/cityList').then((res) => {\n      var msg = res.data.msg;\n      if (msg === 'ok') {\n        var cities = res.data.data.cities;\n        var {cityList,hotList} = this.formatCityList(cities);\n        this.cityList = cityList;\n        this.hotList = hotList;\n      }\n    })\n  },\n  methods: {\n    formatCityList(cities){\n      var cityList = [];\n      var hotList = [];\n\n      for(var i = 0; i<cities.length; i++){\n        if (cities[i].isHot === 1) {\n          hotList.push(cities[i]);\n        }\n      }\n\n      for (var i = 0; i < cities.length; i++) {\n        var firstLetter = cities[i].py.substring(0,1).toUpperCase();\n        if (toCom(firstLetter)) {//新添加index\n          cityList.push({ index : firstLetter, list : [ { nm : cities[i].nm, id :cities[i].id } ] });\n        }\n        else{//累加已有index\n          for (var j = 0; j < cityList.length; j++) {\n            if (cityList[j].index === firstLetter) {\n              cityList[j].list.push({ nm:cities[i].nm, id : cities[i].id});\n            }\n          }\n        }\n      }\n\n      cityList.sort((n1,n2) => {\n        if (n1.index > n2.index) {\n          return 1;\n        }\n        else if(n1.index < n2.index){\n          return -1;\n        }else{\n          return 0;\n        }\n      });\n\n      function toCom(firstLetter) {\n        for (var i = 0; i < cityList.length; i++) {\n          if (cityList[i].index === firstLetter) {\n            return false;\n          }\n        }\n        return true;\n      }\n      return {\n        cityList,\n        hotList\n      }\n    },\n    handleToIndex(index){\n      var h2 = this.$refs.city_sort.getElementsByTagName('h2');\n      this.$refs.city_sort.parentNode.scrollTop = h2[index].offsetTop;\n    }\n  },\n}\n</script>\n<style scoped>\n#content .city_body{ margin-top: 45px; display: flex; width:100%; position: absolute; top: 0; bottom: 0;}\n.city_body .city_list{ flex:1; overflow: auto; background: #FFF5F0;}\n.city_body .city_list::-webkit-scrollbar{\n    background-color:transparent;\n    width:0;\n}\n.city_body .city_hot{ margin-top: 20px;}\n.city_body .city_hot h2{ padding-left: 15px; line-height: 30px; font-size: 14px; background:#F0F0F0; font-weight: normal;}\n.city_body .city_hot ul li{ float: left; background: #fff; width: 29%; height: 33px; margin-top: 15px; margin-left: 3%; padding: 0 4px; border: 1px solid #e6e6e6; border-radius: 3px; line-height: 33px; text-align: center; box-sizing: border-box;}\n.city_body .city_sort div{ margin-top: 20px;}\n.city_body .city_sort h2{ padding-left: 15px; line-height: 30px; font-size: 14px; background:#F0F0F0; font-weight: normal;}\n.city_body .city_sort ul{ padding-left: 10px; margin-top: 10px;}\n.city_body .city_sort ul li{ line-height: 30px; line-height: 30px;}\n.city_body .city_index{ width:20px; display: flex; flex-direction:column; justify-content:center; text-align: center; border-left:1px #e6e6e6 solid;}\n</style>"]}]}